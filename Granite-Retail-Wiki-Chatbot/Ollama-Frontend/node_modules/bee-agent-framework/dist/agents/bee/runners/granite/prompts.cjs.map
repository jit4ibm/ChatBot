{"version":3,"sources":["../../../../../src/agents/bee/runners/granite/prompts.ts"],"names":["GraniteBeeAssistantPrompt","BeeAssistantPrompt","fork","config","template","GraniteBeeSystemPrompt","BeeSystemPrompt","defaults","instructions","functions","formatDate","date","createdAt","Date","Intl","DateTimeFormat","dateStyle","timeStyle","format","GraniteBeeSchemaErrorPrompt","BeeSchemaErrorPrompt","GraniteBeeUserPrompt","BeeUserPrompt","GraniteBeeToolNotFoundPrompt","BeeToolNotFoundPrompt","GraniteBeeToolErrorPrompt","BeeToolErrorPrompt","GraniteBeeToolInputErrorPrompt","BeeToolInputErrorPrompt"],"mappings":";;;;;;AA0BO,MAAMA,yBAA4BC,GAAAA,8BAAAA,CAAmBC,IAAK,CAAA,CAACC,MAAY,MAAA;EAC5E,GAAGA,MAAAA;EACHC,QAAU,EAAA,CAAA;;;;AACZ,CAAA,CAAA;AAEO,MAAMC,sBAAyBC,GAAAA,2BAAAA,CAAgBJ,IAAK,CAAA,CAACC,MAAY,MAAA;EACtE,GAAGA,MAAAA;EACHI,QAAU,EAAA;AACR,IAAA,GAAGJ,MAAOI,CAAAA,QAAAA;IACVC,YAAc,EAAA;AAChB,GAAA;EACAC,SAAW,EAAA;AACT,IAAA,GAAGN,MAAOM,CAAAA,SAAAA;AACVC,IAAAA,UAAAA,kBAAY,MAAA,CAAA,WAAA;AACV,MAAMC,MAAAA,IAAAA,GAAO,KAAKC,SAAY,GAAA,IAAIC,KAAK,IAAKD,CAAAA,SAAS,CAAI,mBAAA,IAAIC,IAAAA,EAAAA;AAC7D,MAAO,OAAA,IAAIC,IAAKC,CAAAA,cAAAA,CAAe,OAAS,EAAA;QACtCC,SAAW,EAAA,MAAA;QACXC,SAAW,EAAA;OACb,CAAA,CAAGC,OAAOP,IAAAA,CAAAA;KALA,EAAA,YAAA;AAOd,GAAA;EACAP,QAAU,EAAA,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyCZ,CAAA,CAAA;AAEO,MAAMe,2BAA8BC,GAAAA,gCAAAA,CAAqBlB,IAAK,CAAA,CAACC,MAAY,MAAA;EAChF,GAAGA,MAAAA;EACHC,QAAU,EAAA,CAAA;;AAEZ,CAAA,CAAA;AAEO,MAAMiB,oBAAuBC,GAAAA,yBAAAA,CAAcpB,IAAK,CAAA,CAACC,MAAY,MAAA;EAClE,GAAGA,MAAAA;EACHC,QAAU,EAAA,CAAA,SAAA;AACZ,CAAA,CAAA;AAEO,MAAMmB,4BAA+BC,GAAAA,iCAAAA,CAAsBtB,IAAK,CAAA,CAACC,MAAY,MAAA;EAClF,GAAGA,MAAAA;EACHC,QAAU,EAAA,CAAA;;;;AAIZ,CAAA,CAAA;AAEO,MAAMqB,yBAA4BC,GAAAA,8BAAAA,CAAmBxB,IAAK,CAAA,CAACC,MAAY,MAAA;EAC5E,GAAGA,MAAAA;EACHC,QAAU,EAAA,CAAA;;;AAGZ,CAAA,CAAA;AAEO,MAAMuB,8BAAiCC,GAAAA,mCAAAA,CAAwB1B,IAAK,CAAA,CAACC,MAAY,MAAA;EACtF,GAAGA,MAAAA;EACHC,QAAU,EAAA,CAAA;;;AAGZ,CAAA,CAAA","file":"prompts.cjs","sourcesContent":["/**\n * Copyright 2024 IBM Corp.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  BeeAssistantPrompt,\n  BeeSchemaErrorPrompt,\n  BeeSystemPrompt,\n  BeeToolErrorPrompt,\n  BeeToolInputErrorPrompt,\n  BeeToolNotFoundPrompt,\n  BeeUserPrompt,\n} from \"@/agents/bee/prompts.js\";\n\nexport const GraniteBeeAssistantPrompt = BeeAssistantPrompt.fork((config) => ({\n  ...config,\n  template: `{{#thought}}Thought: {{.}}\\n{{/thought}}{{#toolName}}Tool Name: {{.}}\\n{{/toolName}}{{#toolInput}}Tool Input: {{.}}\\n{{/toolInput}}{{#finalAnswer}}Final Answer: {{.}}{{/finalAnswer}}`,\n}));\n\nexport const GraniteBeeSystemPrompt = BeeSystemPrompt.fork((config) => ({\n  ...config,\n  defaults: {\n    ...config.defaults,\n    instructions: \"\",\n  },\n  functions: {\n    ...config.functions,\n    formatDate: function () {\n      const date = this.createdAt ? new Date(this.createdAt) : new Date();\n      return new Intl.DateTimeFormat(\"en-US\", {\n        dateStyle: \"full\",\n        timeStyle: \"medium\",\n      }).format(date);\n    },\n  },\n  template: `You are an AI assistant.\nWhen the user sends a message figure out a solution and provide a final answer.\n{{#tools.length}}\nYou have access to a set of tools that can be used to retrieve information and perform actions.\nPay close attention to the tool description to determine if a tool is useful in a particular context.\n{{/tools.length}}\n\n# Communication structure\nYou communicate only in instruction lines. Valid instruction lines are 'Thought' followed by 'Tool Name' and then 'Tool Input', or 'Thought' followed by 'Final Answer'\n\nLine starting 'Thought: ' The assistant's response always starts with a thought, this is a single line where the assistant thinks about the user's message and describes in detail what it should do next.\n{{#tools.length}}\nIn a 'Thought: ', the assistant should determine if a Tool Call is necessary to get more information or perform an action, or if the available information is sufficient to provide the Final Answer.\nIf a tool needs to be called and is available, the assistant will produce a tool call:\nLine starting 'Tool Name: ' name of the tool that you want to use.\nLine starting 'Tool Input: ' JSON formatted tool arguments adhering to the selected tool parameters schema i.e. {\"arg1\":\"value1\", \"arg2\":\"value2\"}.\nAfter a 'Tool Input: ' the next message will contain a tool response. The next output should be a 'Thought: ' where the assistant thinks about the all the information it has available, and what it should do next (e.g. try the same tool with a different input, try a different tool, or proceed with answering the original user question).\n{{/tools.length}}\nOnce enough information is available to provide the Final Answer, the last line in the message needs to be:\nLine starting 'Final Answer: ' followed by a concise and clear answer to the original message.\n\n# Best practices\n- Use markdown syntax for formatting code snippets, links, JSON, tables, images, files.\n{{#tools.length}}\n- Do not attempt to use a tool that is not listed in available tools. This will cause an error.\n- Make sure that tool input is in the correct format and contains the correct arguments.\n{{/tools.length}}\n- When the message is unclear, respond with a line starting with 'Final Answer:' followed by a request for additional information needed to solve the problem.\n- When the user wants to chitchat instead, always respond politely.\n\n# Date and Time\nThe current date and time is: {{formatDate}}\n{{#tools.length}}\nYou do not need a tool to get the current Date and Time. Use the information available here.\n{{/tools.length}}\n\n{{#instructions}} \n# Additional instructions\n{{.}} \n{{/instructions}}\n`,\n}));\n\nexport const GraniteBeeSchemaErrorPrompt = BeeSchemaErrorPrompt.fork((config) => ({\n  ...config,\n  template: `Error: The generated response does not adhere to the communication structure mentioned in the system prompt.\nYou communicate only in instruction lines. Valid instruction lines are 'Thought' followed by 'Tool Name' and then 'Tool Input' or 'Thought' followed by 'Final Answer'.`,\n}));\n\nexport const GraniteBeeUserPrompt = BeeUserPrompt.fork((config) => ({\n  ...config,\n  template: `{{input}}`,\n}));\n\nexport const GraniteBeeToolNotFoundPrompt = BeeToolNotFoundPrompt.fork((config) => ({\n  ...config,\n  template: `Tool does not exist!\n{{#tools.length}}\nUse one of the following tools: {{#trim}}{{#tools}}{{name}},{{/tools}}{{/trim}}\n{{/tools.length}}`,\n}));\n\nexport const GraniteBeeToolErrorPrompt = BeeToolErrorPrompt.fork((config) => ({\n  ...config,\n  template: `The tool has failed; the error log is shown below. If the tool cannot accomplish what you want, use a different tool or explain why you can't use it.\n\n{{reason}}`,\n}));\n\nexport const GraniteBeeToolInputErrorPrompt = BeeToolInputErrorPrompt.fork((config) => ({\n  ...config,\n  template: `{{reason}}\n\nHINT: If you're convinced that the input was correct but the tool cannot process it then use a different tool or say I don't know.`,\n}));\n"]}